const connection = require ("./connection")
const {mainMenu} = require("../index")

function viewEmployees(){
    connection.query(
        `SELECT employee.id, employee.first_name, employee.last_name, employee.manager_name, roles.title, roles.salary, department.name
        FROM department
        JOIN roles ON roles.department_id  = department.id
        JOIN employee ON employee.role_id = roles.id;`, async function(err , rows){
            return console.table(rows)
            })
}

function viewDepartments(){
    connection.query(
        `SELECT * FROM department`, async function (err, rows){
            console.log(rows)
            // await mainMenu();
        }
    )
}

function viewRoles(){
    connection.query(
    `SELECT roles.title, roles.id, roles.salary, department.name FROM department JOIN roles ON roles.department_id  = department.id;`, async function(err, rows){
        console.table(rows)
        // await mainMenu();
        }
    )
}

function addDepartment(){
    inquirer
        .prompt([
            {
                type: "input",
                message: "What's the new department's name?",
                name: "DepartmentName"
            }
        ])
        .then((res)=>{
            let newName = res.DepartmentName
            connection.query(
            `INSERT INTO department (name) VALUES ("${newName}");`, async function (){
                console.log("Successfully added!")
                // mainMenu();
            })
        })
}

// function quit(){
//     console.log("Goodbye!");
//     process.exit()
// }

module.exports = {viewEmployees, viewDepartments, viewRoles, addDepartment}